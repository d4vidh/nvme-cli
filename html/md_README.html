<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NVME_CLI_DOC: nvme-cli</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NVME_CLI_DOC
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">nvme-cli </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>NVM-Express user space tooling for Linux.</p>
<p>To install, run: </p><pre class="fragment">$ make
# make install
</pre><p>If not sure how to use, find the top-level documentation with: </p><pre class="fragment">$ man nvme
</pre><p>Or find a short summary with: </p><pre class="fragment">$ nvme help
</pre><h1><a class="anchor" id="autotoc_md4"></a>
Distro Support</h1>
<h2><a class="anchor" id="autotoc_md5"></a>
Alpine Linux</h2>
<p>nvme-cli is tested on Alpine Linux 3.3. Install it using: </p><pre class="fragment"># apk update &amp;&amp; apk add nvme-cli nvme-cli-doc
</pre><p>if you just use the device you're after, it will work flawless. </p><div class="fragment"><div class="line"># nvme smart-log /dev/nvme0</div>
<div class="line">Smart Log for NVME device:/dev/nvme0 namespace-id:ffffffff</div>
<div class="line">critical_warning                    : 0</div>
<div class="line">temperature                         : 49 C</div>
<div class="line">available_spare                     : 100%</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
Arch Linux</h2>
<p>nvme-cli is available in the <code>[community]</code> repository. It can be installed with: </p><pre class="fragment"># pacman -S nvme-cli
</pre><p>The development version can be installed from AUR, e.g.: </p><pre class="fragment">$ yay -S nvme-cli-git
</pre><h2><a class="anchor" id="autotoc_md7"></a>
Debian</h2>
<p>nvme-cli is available in Debian 9 and up. Install it with your favorite package manager. For example: </p><pre class="fragment">$ sudo apt install nvme-cli
</pre><h2><a class="anchor" id="autotoc_md8"></a>
Fedora</h2>
<p>nvme-cli is available in Fedora 23 and up. Install it with your favorite package manager. For example: </p><pre class="fragment">$ sudo dnf install nvme-cli
</pre><h2><a class="anchor" id="autotoc_md9"></a>
FreeBSD</h2>
<p><code>nvme-cli</code> is available in the FreeBSD Ports Collection. A prebuilt binary package can be installed with:</p>
<div class="fragment"><div class="line"># pkg install nvme-cli</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md10"></a>
Gentoo</h2>
<p>nvme-cli is available and tested in portage: </p><div class="fragment"><div class="line">$ emerge -av nvme-cli</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
Nix(OS)</h2>
<p>The attribute is named <code>nvme-cli</code> and can e.g. be installed with: </p><div class="fragment"><div class="line">$ nix-env -f &#39;&lt;nixpkgs&gt;&#39; -iA nvme-cli</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md12"></a>
openSUSE</h2>
<p>nvme-cli is available in openSUSE Leap 42.2 or later and Tumbleweed. You can install it using zypper. For example: </p><pre class="fragment">$ sudo zypper install nvme-cli
</pre><h2><a class="anchor" id="autotoc_md13"></a>
Ubuntu</h2>
<p>nvme-cli is supported in the Universe package sources for Xenial for many architectures. For a complete list try running: </p><div class="fragment"><div class="line">rmadison nvme-cli</div>
<div class="line"> nvme-cli | 0.3-1 | xenial/universe | source, amd64, arm64, armhf, i386, powerpc, ppc64el, s390x</div>
</div><!-- fragment --><p>A Debian based package for nvme-cli is currently maintained as a Ubuntu PPA. Right now there is support for Trusty, Vivid and Wiley. To install nvme-cli using this approach please perform the following steps:</p><ol type="1">
<li>Add the sbates PPA to your sources. One way to do this is to run <div class="fragment"><div class="line">sudo add-apt-repository ppa:sbates</div>
</div><!-- fragment --></li>
<li>Perform an update of your repository list: <div class="fragment"><div class="line">sudo apt-get update</div>
</div><!-- fragment --></li>
<li>Get nvme-cli! <div class="fragment"><div class="line">sudo apt-get install nvme-cli</div>
</div><!-- fragment --></li>
<li>Test the code. <div class="fragment"><div class="line">sudo nvme list</div>
</div><!-- fragment --></li>
</ol>
<p>In the case of no NVMe devices you will see </p><div class="fragment"><div class="line">No NVMe devices detected.</div>
</div><!-- fragment --><p>otherwise you will see information about each NVMe device installed in the system.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
OpenEmbedded/Yocto</h2>
<p>An <a href="https://layers.openembedded.org/layerindex/recipe/88631/">nvme-cli recipe</a> is available as part of the <code>meta-openembeded</code> layer collection.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Buildroot</h2>
<p><code>nvme-cli</code> is available as <a href="https://buildroot.org">buildroot</a> package. The package is named <code>nvme</code>.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Other Distros</h2>
<p>TBD</p>
<h1><a class="anchor" id="autotoc_md17"></a>
Developers</h1>
<p>You may wish to add a new command or possibly an entirely new plug-in for some special extension outside the spec.</p>
<p>This project provides macros that help generate the code for you. If you're interested in how that works, it is very similar to how trace events are created by Linux kernel's 'ftrace' component.</p>
<h2><a class="anchor" id="autotoc_md18"></a>
Add command to existing built-in</h2>
<p>The first thing to do is define a new command entry in the command list. This is declared in <a class="el" href="nvme-builtin_8h_source.html">nvme-builtin.h</a>. Simply append a new "ENTRY" into the list. The ENTRY normally takes three arguments: the "name" of the subcommand (this is what the user will type at the command line to invoke your command), a short help description of what your command does, and the name of the function callback that you're going to write. Additionally, You can declare an alias name of subcommand with fourth argument, if needed.</p>
<p>After the ENTRY is defined, you need to implement the callback. It takes four arguments: argc, argv, the command structure associated with the callback, and the plug-in structure that contains that command. The prototype looks like this:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> f(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv, <span class="keyword">struct</span> <a class="code" href="structcommand.html">command</a> *cmd, <span class="keyword">struct</span> <a class="code" href="structplugin.html">plugin</a> *<a class="code" href="structplugin.html">plugin</a>);</div>
</div><!-- fragment --><p>The argc and argv are adjusted from the command line arguments to start after the sub-command. So if the command line is "nvme foo --option=bar", the argc is 1 and argv starts at "--option".</p>
<p>You can then define argument parsing for your sub-command's specific options then do some command specific action in your callback.</p>
<h2><a class="anchor" id="autotoc_md19"></a>
Add a new plugin</h2>
<p>The nvme-cli provides macros to make define a new plug-in simpler. You can certainly do all this by hand if you want, but it should be easier to get going using the macros. To start, first create a header file to define your plugin. This is where you will give your plugin a name, description, and define all the sub-commands your plugin implements.</p>
<p>There is a very important order on how to define the plugin. The following is a basic example on how to start this:</p>
<p>File: foo-plugin.h </p><div class="fragment"><div class="line"><span class="preprocessor">#undef CMD_INC_FILE</span></div>
<div class="line"><span class="preprocessor">#define CMD_INC_FILE plugins/foo/foo-plugin</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if !defined(FOO) || defined(CMD_HEADER_MULTI_READ)</span></div>
<div class="line"><span class="preprocessor">#define FOO</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;cmd.h&quot;</span></div>
<div class="line"> </div>
<div class="line">PLUGIN(NAME(<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;Foo plugin&quot;</span>),</div>
<div class="line">    COMMAND_LIST(</div>
<div class="line">        ENTRY(<span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;foo bar&quot;</span>, bar)</div>
<div class="line">        ENTRY(<span class="stringliteral">&quot;baz&quot;</span>, <span class="stringliteral">&quot;foo baz&quot;</span>, baz)</div>
<div class="line">        ENTRY(<span class="stringliteral">&quot;qux&quot;</span>, <span class="stringliteral">&quot;foo quz&quot;</span>, qux)</div>
<div class="line">    )</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;define_cmd.h&quot;</span></div>
</div><!-- fragment --><p>In order to have the compiler generate the plugin through the xmacro expansion, you need to include this header in your source file, with pre-defining macro directive to create the commands.</p>
<p>To get started from the above example, we just need to define "CREATE_CMD" and include the header:</p>
<p>File: foo-plugin.c </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;nvme.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CREATE_CMD</span></div>
<div class="line"><span class="preprocessor">#include &quot;foo-plugin.h&quot;</span></div>
</div><!-- fragment --><p>After that, you just need to implement the functions you defined in each ENTRY, then append the object file name to the Makefile's "OBJS". </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="astructplugin_html"><div class="ttname"><a href="structplugin.html">plugin</a></div><div class="ttdef"><b>Definition:</b> plugin.h:16</div></div>
<div class="ttc" id="astructcommand_html"><div class="ttname"><a href="structcommand.html">command</a></div><div class="ttdef"><b>Definition:</b> plugin.h:25</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
